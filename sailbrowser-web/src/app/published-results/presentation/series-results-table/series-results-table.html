
   <table mat-table class="table" [dataSource]="tableData()" [trackBy]="tackByKey">

      <!-- Initial columns -->
      <ng-container matColumnDef="position" sticky>
         <th mat-header-cell class="positioncolumn" *matHeaderCellDef mat-sort-header>Pos</th>
         <td mat-cell class="positioncolumn" *matCellDef="let competitor"
            (click)="updateSelectedCompetitor(competitor)">
            <span>{{'xxx'}}</span>
         </td>
      </ng-container>

      <ng-container matColumnDef="name" sticky>
         <th mat-header-cell class="namecolumn" *matHeaderCellDef>Name</th>
         <td mat-cell *matCellDef="let competitor">
            {{competitor.name}}
            <br> {{competitor.club}}
         </td>
      </ng-container>

      <ng-container matColumnDef="total" sticky>
         <th mat-header-cell class="timecolumn" *matHeaderCellDef mat-sort-header>Total</th>
         <td mat-cell *matCellDef="let competitor"> {{ 'xxxx' }} </td>
      </ng-container>

      <!-- Splits times columns -->
      @for (race of raceColumns(); track race; let count = $index) {
      @let i = count + 1;
      <ng-container [matColumnDef]="race">
         <th mat-header-cell class="splitcolumn" *matHeaderCellDef mat-sort-header> {{ raceTitle(i) }}</th>
         <td mat-cell  *matCellDef="let comp">
            @let rank = comp.getSplitRankTo(i);
            <span [class.fastest]="rank===1" [class.second]="rank===2" [class.third]="rank===3">
               {{ comp.getSplitTimeTo(i) }}
            </span>
            <br>
            @if (i !== 1) {
            @let rank = comp.getCumulativeRankTo(i);
            <span [class.fastest]="rank===1" [class.second]="rank===2" [class.third]="rank===3">
               {{ comp.getCumulativeTimeTo(i) }}
            </span>
            }
            <br>
         </td>
      </ng-container>
      }

      <tr mat-header-row *matHeaderRowDef="displayedColumns(); sticky: true"></tr>
      <tr mat-row *matRowDef="let competitor; columns: displayedColumns();"
         [class.selected]="isCompetitorSelected(competitor)">
      </tr>
   </table>
