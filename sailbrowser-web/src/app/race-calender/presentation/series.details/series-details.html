@if (rc.isLoading()) {
<app-loading-centered />
} @else if (rc.error()) {
<app-loading-centered message="Error encountered" />
} @else if (!series()) {
Series not found
} @else {
@let s = series();

<app-toolbar title="Series Details">
   <button matIconButton (click)="copySeries(series())">
      <mat-icon>content_copy</mat-icon>
   </button>
</app-toolbar>

<div class="content">

   <mat-card appearance="outlined">
      <mat-card-header>
         <mat-card-title>
            <span>{{ series().name }}</span>
         </mat-card-title>
         <mat-card-subtitle>
            <span>{{fleet()?.name}}</span>
            @if (s.startDate && s.endDate) {
            <span>{{ s.startDate| date:'MMM d, y' }} to {{ s.endDate | date:'MMM d, y' }}</span>
            }
         </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
         @let scoring = s.scoringScheme;
         <div class="scoring-details">
            <div class="detail-item">
               <span class="detail-label">Scoring Scheme:</span>
               <span class="detail-value">{{ scoringSchemeName() }}</span>
            </div>
            
            <div class="detail-item">
               <span class="detail-label">Discards:</span>
               <span class="detail-value">
                  Initial after {{ scoring.initialDiscardAfter}} races then every {{ scoring.subsequentDiscardsEveryN}}
               </span>
            </div>

            <div class="detail-item">
               <span class="detail-label">Handicap system:</span>
               <span class="detail-value">{{ scoring.handicapSystem }}</span>
            </div>
            
            <div class="detail-item">
               <span class="detail-label">Entry Grouping:</span>
               <span class="detail-value">{{ entryAlgorithmName() }}</span>
            </div>
         </div>
         
      </mat-card-content>
      <mat-card-actions align="end">
         <button matButton (click)="editSeries(s.id)" title="Edit Series">
            Edit Details
         </button>

         <button matButton (click)="deleteSeries(s.id)">
            Delete Series
         </button>
      </mat-card-actions>
   </mat-card>

   <!-- Races Header -->
   <div class="race-header">
      <h2>Races</h2>
      <span class="spacer"></span>
      <button matIconButton (click)="addRace(s.id)">
         <mat-icon>add_circle_outline</mat-icon>
      </button>
   </div>

   <!-- Races List -->
   @if (this.rc.racesLoading()) {
   <app-loading-centered />
   }
   @if (this.races().length === 0) {
   <span>`Add races to the series"</span>
   } @else {
   <mat-list>
      @for (race of races(); track race.id) {
      <app-race-list-item [race]="race" (edit)="editRace(race)" (delete)="deleteRace(race)" />
      }

   </mat-list>

   }
</div>
}